

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Stack Config &mdash; Sceptre 1.3.3 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Templates" href="templates.html" />
    <link rel="prev" title="Environment Config" href="environment_config.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Sceptre
          

          
          </a>

          
            
            
              <div class="version">
                95.2.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="get_started.html">Get Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="terminology.html">Terminology</a></li>
</ul>
<p class="caption"><span class="caption-text">Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="cli.html">Command Line Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="environment_config.html">Environment Config</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Stack Config</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#structure">Structure</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#dependencies">dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="#hooks">hooks</a></li>
<li class="toctree-l3"><a class="reference internal" href="#on-failure">on_failure</a></li>
<li class="toctree-l3"><a class="reference internal" href="#parameters">parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#protect">protect</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sceptre-user-data">sceptre_user_data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#stack-name">stack_name</a></li>
<li class="toctree-l3"><a class="reference internal" href="#stack-tags">stack_tags</a></li>
<li class="toctree-l3"><a class="reference internal" href="#role-arn">role_arn</a></li>
<li class="toctree-l3"><a class="reference internal" href="#notifications">notifications</a></li>
<li class="toctree-l3"><a class="reference internal" href="#stack-timeout">stack_timeout</a></li>
<li class="toctree-l3"><a class="reference internal" href="#template-path">template_path</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#cascading-config">Cascading Config</a></li>
<li class="toctree-l2"><a class="reference internal" href="#templating">Templating</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#environment-config">Environment config</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#environment-variables">Environment Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id1">Sceptre User Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#examples">Examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="templates.html">Templates</a></li>
<li class="toctree-l1"><a class="reference internal" href="hooks.html">Hooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="resolvers.html">Resolvers</a></li>
<li class="toctree-l1"><a class="reference internal" href="architecture.html">Architecting Sceptre</a></li>
</ul>
<p class="caption"><span class="caption-text">Support</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ</a></li>
</ul>
<p class="caption"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/modules.html">sceptre</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Sceptre</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Stack Config</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/docs/stack_config.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="stack-config">
<h1>Stack Config<a class="headerlink" href="#stack-config" title="Permalink to this headline">¶</a></h1>
<p>Stack config stores config related to a particular stack, such as the
path to that stack’s template, and any parameters that stack may
require.</p>
<div class="section" id="structure">
<h2>Structure<a class="headerlink" href="#structure" title="Permalink to this headline">¶</a></h2>
<p>A stack config file is a yaml object of key-value pairs configuring a
particular stack. The available keys are listed below.</p>
<ul class="simple">
<li><a class="reference internal" href="#dependencies">dependencies</a> <em>(optional)</em></li>
<li><a class="reference internal" href="#hooks">hooks</a> <em>(optional)</em></li>
<li><a class="reference internal" href="#on-failure">on_failure</a> <em>(optional)</em></li>
<li><a class="reference internal" href="#parameters">parameters</a> <em>(optional)</em></li>
<li><a class="reference internal" href="#protect">protect</a> <em>(optional)</em></li>
<li><a class="reference internal" href="#sceptre-user-data">sceptre_user_data</a> <em>(optional)</em></li>
<li><a class="reference internal" href="#stack-name">stack_name</a> <em>(optional)</em></li>
<li><a class="reference internal" href="#stack-tags">stack_tags</a> <em>(optional)</em></li>
<li><a class="reference internal" href="#role-arn">role_arn</a> <em>(optional)</em></li>
<li><a class="reference internal" href="#notifications">notifications</a> <em>(optional)</em></li>
<li><a class="reference internal" href="#template-path">template_path</a> <em>(required)</em></li>
<li><a class="reference internal" href="#stack-timeout">stack_timeout</a> <em>(optional)</em></li>
</ul>
<div class="section" id="dependencies">
<h3>dependencies<a class="headerlink" href="#dependencies" title="Permalink to this headline">¶</a></h3>
<p>A list of other stacks in the environment that this stack depends on.
Note that if a stack fetches an output value from another stack using
the <code class="docutils literal notranslate"><span class="pre">stack_output</span></code> resolver, that stack is automatically added as a
dependency, and that stack need not be added as an explicit dependency
here.</p>
</div>
<div class="section" id="hooks">
<h3>hooks<a class="headerlink" href="#hooks" title="Permalink to this headline">¶</a></h3>
<p>A list of arbitrary shell or python commands or scripts to run. Find out
more in the <a class="reference internal" href="hooks.html#hooks"><span class="std std-ref">Hooks</span></a> section.</p>
</div>
<div class="section" id="on-failure">
<h3>on_failure<a class="headerlink" href="#on-failure" title="Permalink to this headline">¶</a></h3>
<p>This parameter describes the action taken by CloudFormation when a stack
fails to create. For more information and valid values see the <a class="reference external" href="http://docs.aws.amazon.com/AWSCloudFormation/latest/APIReference/API_CreateStack.html">AWS
Documentation</a>.</p>
</div>
<div class="section" id="parameters">
<h3>parameters<a class="headerlink" href="#parameters" title="Permalink to this headline">¶</a></h3>
<div class="admonition danger">
<p class="first admonition-title">Danger</p>
<p class="last">Sensitive data such as passwords or secret keys should not be stored in
plaintext in stack config files. Instead, they should be passed in from
the CLI with User Variables, or set via an environment variable with the
environment variable resolver.</p>
</div>
<p>A dictionary of key-value pairs to be supplied to a template as
parameters. The keys must match up with the name of the parameter, and
the value must be of the type as defined in the template. Note that
Boto3 throws an exception if parameters are supplied to a template that
are not required by that template. Resolvers can be used to add
functionality to this key. Find out more in the  <a class="reference internal" href="resolvers.html#resolvers"><span class="std std-ref">Resolvers</span></a> section.</p>
<p>A parameter can be specified either as a single value/resolver or a list
of values/resolvers. Lists of values/resolvers will be formatted into an
AWS compatible comma separated string e.g. <code class="docutils literal notranslate"><span class="pre">value1,value2,value3</span></code>.
Lists can contain a mixture of values and resolvers.</p>
<p>Syntax:</p>
<div class="code yaml highlight-default notranslate"><div class="highlight"><pre><span></span>parameters:
    &lt;parameter1_name&gt;: &quot;value&quot;
    &lt;parameter2_name&gt;: !&lt;resolver_name&gt; &lt;resolver_value&gt;
    &lt;parameter3_name&gt;:
        - &quot;value1&quot;
        - &quot;value2&quot;
    &lt;parameter4_name&gt;:
        - !&lt;resolver_name&gt; &lt;resolver_value&gt;
        - !&lt;resolver_name&gt; &lt;resolver_value&gt;
    &lt;parameter5_name&gt;:
        - !&lt;resolver_name&gt; &lt;resolver_value&gt;
        - &quot;value1&quot;
</pre></div>
</div>
<p>Example:</p>
<div class="code yaml highlight-default notranslate"><div class="highlight"><pre><span></span>parameters:
    database_username: &quot;mydbuser&quot;
    database_password: !environment_variable DATABASE_PASSWORD
    subnet_ids:
        - &quot;subnet-12345678&quot;
        - &quot;subnet-87654321&quot;
    security_group_ids:
        - &quot;sg-12345678&quot;
        - !stack_output security-groups::BaseSecurityGroupId
        - !file_contents /file/with/security_group_id.txt
</pre></div>
</div>
</div>
<div class="section" id="protect">
<h3>protect<a class="headerlink" href="#protect" title="Permalink to this headline">¶</a></h3>
<p>Stack protection against execution of the following commands:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">launch-stack</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">create-stack</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">update-stack</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">delete-stack</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">execute-change-set</span></code></li>
</ul>
<p>If a user tries to run one of these commands on a protected stack,
Sceptre will throw an error.</p>
</div>
<div class="section" id="sceptre-user-data">
<h3>sceptre_user_data<a class="headerlink" href="#sceptre-user-data" title="Permalink to this headline">¶</a></h3>
<p>Represents data to be passed to the
<code class="docutils literal notranslate"><span class="pre">sceptre_handler(sceptre_user_data)</span></code> function in Python templates or
accessible under <code class="docutils literal notranslate"><span class="pre">sceptre_user_data</span></code> variable key within Jinja2
templates.</p>
</div>
<div class="section" id="stack-name">
<h3>stack_name<a class="headerlink" href="#stack-name" title="Permalink to this headline">¶</a></h3>
<p>A custom name name to use instead of the Sceptre default, e.g:</p>
<div class="code yaml highlight-default notranslate"><div class="highlight"><pre><span></span>parameters:
    VpcID: !stack_output_external &lt;custom-named-vpc-stack&gt;::VpcID
dependencies:
    - &lt;environment&gt;/&lt;stack&gt;
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Outputs from stacks with custom names can’t be resolved using the
standard stack output resolver. Outputs should be resolved using the
stack output external resolver. An explicit dependency should be added,
using the dependencies parameter, to make sure the stacks are launched
in the correct order.</p>
</div>
</div>
<div class="section" id="stack-tags">
<h3>stack_tags<a class="headerlink" href="#stack-tags" title="Permalink to this headline">¶</a></h3>
<p>A dictionary of <a class="reference external" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/APIReference/API_Tag.html">CloudFormation
Tags</a>
to be applied to the stack.</p>
</div>
<div class="section" id="role-arn">
<h3>role_arn<a class="headerlink" href="#role-arn" title="Permalink to this headline">¶</a></h3>
<p>The ARN of a <a class="reference external" href="http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-iam-servicerole.html">CloudFormation Service
Role</a>
that is assumed by CloudFormation to create, update or delete resources.</p>
</div>
<div class="section" id="notifications">
<h3>notifications<a class="headerlink" href="#notifications" title="Permalink to this headline">¶</a></h3>
<p>List of SNS topic ARNs to publish stack related events to. A maximum of
5 ARNs can be specified per stack. This configuration will be used by
the <code class="docutils literal notranslate"><span class="pre">create-stack</span></code>, <code class="docutils literal notranslate"><span class="pre">update-stack</span></code>, and <code class="docutils literal notranslate"><span class="pre">create-change-set</span></code>
commands. More information about stack notifications can found under the
relevant section in the <a class="reference external" href="http://docs.aws.amazon.com/AWSCloudFormation/latest/APIReference/API_CreateStack.html">AWS CloudFormation API
documentation</a>.</p>
</div>
<div class="section" id="stack-timeout">
<h3>stack_timeout<a class="headerlink" href="#stack-timeout" title="Permalink to this headline">¶</a></h3>
<p>A timeout in minutes before considering the stack deployment as failed.
After the specified timeout, the stack will be rolled back. Specifiyng
zero, as well as ommiting the field, will result in no timeout. Supports
only positive integer value.</p>
</div>
<div class="section" id="template-path">
<h3>template_path<a class="headerlink" href="#template-path" title="Permalink to this headline">¶</a></h3>
<p>The path to the CloudFormation, Jinja2 or Python template to build the
stack from. The path can either be absolute or relative to the Sceptre
Directory. Sceptre treats the template as CloudFormation, Jinja2 or
Python depending on the template’s file extension. Note that the
template filename may be different from the stack config filename.</p>
</div>
</div>
<div class="section" id="cascading-config">
<h2>Cascading Config<a class="headerlink" href="#cascading-config" title="Permalink to this headline">¶</a></h2>
<p>Stack config can be cascaded in the same way Environment config can be,
as described in the section in Environment Config on <a class="reference external" href="%7B%7B%20site.baseurl%20%7D%7D/docs/environment_config.html#cascading-config">Cascading
Config</a>.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Cascading stack config is being deprecated, and should not be used.</p>
</div>
</div>
<div class="section" id="templating">
<h2>Templating<a class="headerlink" href="#templating" title="Permalink to this headline">¶</a></h2>
<p>Stack config supports templating in the same way Environment config can
be, as described in the section in Environment Config on
<a class="reference external" href="%7B%7B%20site.baseurl%20%7D%7D/docs/environment_config.html#templating">Templating</a>.</p>
<p>Stack config makes environment config available to template.</p>
<div class="section" id="environment-config">
<h3>Environment config<a class="headerlink" href="#environment-config" title="Permalink to this headline">¶</a></h3>
<p>Environment config properties are available via the environment_config
variable when using templating.</p>
<div class="code yaml highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">parameters</span><span class="p">:</span>
  <span class="n">Region</span><span class="p">:</span> <span class="p">{{</span> <span class="n">environment_config</span><span class="o">.</span><span class="n">region</span> <span class="p">}}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="environment-variables">
<h2>Environment Variables<a class="headerlink" href="#environment-variables" title="Permalink to this headline">¶</a></h2>
<p>It is possible to replace values in stack config files with environment
variables in two ways. For an explanation on why this is the case, see
the
<a class="reference external" href="%7B%7B%20site.baseurl%20%7D%7D/docs/faq.html#why-are-there-two-ways-to-supply-environment-variables-in-stack-config-files">FAQ</a>.</p>
</div>
<div class="section" id="id1">
<h2>Sceptre User Data<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>Python or Jinja templates can contain data which should be
parameterised, but can’t be parameterised using CloudFormation
parameters. An example of this is if a Python template which creates an
IAM Role reads in the policy from a JSON file. The file path must be
hardcoded in the Python template.</p>
<p>Sceptre user data allows users to store arbitrary key-value pairs in
their <code class="docutils literal notranslate"><span class="pre">&lt;stack-name&gt;.yaml</span></code> file. This data is then passed as a Python
<code class="docutils literal notranslate"><span class="pre">dict</span></code> to the <code class="docutils literal notranslate"><span class="pre">sceptre_handler(sceptre_user_data)</span></code> function in
Python templates.</p>
<p>Syntax:</p>
<div class="code yaml highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sceptre_user_data</span><span class="p">:</span>
    <span class="n">iam_policy_file_path</span><span class="p">:</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">policy</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<p>When compiled, <code class="docutils literal notranslate"><span class="pre">sceptre_user_data</span></code> would be the dictionary
<code class="docutils literal notranslate"><span class="pre">{&quot;iam_policy_file&quot;:</span> <span class="pre">&quot;/path/to/policy.json&quot;}</span></code>.</p>
</div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<div class="code yaml highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">template_path</span><span class="p">:</span> <span class="n">templates</span><span class="o">/</span><span class="n">example</span><span class="o">.</span><span class="n">py</span>
<span class="n">parameters</span><span class="p">:</span>
    <span class="n">param_1</span><span class="p">:</span> <span class="n">value_1</span>
    <span class="n">param_2</span><span class="p">:</span> <span class="n">value_2</span>
</pre></div>
</div>
<div class="code yaml highlight-default notranslate"><div class="highlight"><pre><span></span>template_path: templates/example.json
dependencies:
    - vpc
hooks:
    before_create:
        - !cmd &quot;echo creating...&quot;
    after_create:
        - !cmd &quot;echo created&quot;
        - !cmd &quot;echo done&quot;
    after_update:
        - !cmd &quot;mkdir example&quot;
        - !cmd &quot;touch example.txt&quot;
parameters:
    param_1: !stack_output stack_name::output_name
    param_2: !stack_output_external full_stack_name::output_name
    param_3: !environment_variable VALUE_3
    param_4:
        {{ var.value4 }}
    param_5:
        {{ environment_path.3 }}
    param_6:
        {{ environment_variable.VALUE_6 }}
sceptre_user_data:
    thing_1: value_1
    thing_2: !file_contents path/to/file.txt
stack_tags:
    tag_1: value_1
    tag_2: value_2
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="templates.html" class="btn btn-neutral float-right" title="Templates" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="environment_config.html" class="btn btn-neutral" title="Environment Config" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Cloudreach.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  
    <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Read the Docs</span>
      v: 95.2.1
      <span class="fa fa-caret-down"></span>
    </span>

        <div class="rst-other-versions">
            <dl id="other-versions">
                <dt>Versions</dt>

                <dd><a href="../stable">stable</a></dd>
            </dl>
            <dl>
                <dt>Links</dt>
                <dd>

                    <a href="///projects//?fromdocs=">Project Home</a>
                </dd>
                <dd>
                    <a href="///builds//?fromdocs=">Builds</a>
                </dd>
            </dl>
            <hr/>
            Free document hosting provided by <a href="http://www.readthedocs.org">Read the Docs</a>
                .

        </div>
        <script>
            document.addEventListener("DOMContentLoaded", function () {
                $.getScript("../../version-helper.js").done(
                    function () {
                        versions.forEach(function (item, index) {
                            if (item !== "95.2.1") {
                                $('#other-versions').append('<dd><a href="../' + item + '">' + item + "<a/></dd>");
                            }

                        })
                    });
            });
        </script>
    </div>


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.3.3',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>