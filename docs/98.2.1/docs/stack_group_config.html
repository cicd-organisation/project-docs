

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>StackGroup Config &mdash; Sceptre 2.0.3 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../',
              VERSION:'2.0.3',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Stack Config" href="stack_config.html" />
    <link rel="prev" title="Command Line Interface" href="cli.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Sceptre
          

          
          </a>

          
            
            
              <div class="version">
                98.2.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="get_started.html">Get Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="terminology.html">Terminology</a></li>
</ul>
<p class="caption"><span class="caption-text">Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="cli.html">Command Line Interface</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">StackGroup Config</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#structure">Structure</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#profile">profile</a></li>
<li class="toctree-l3"><a class="reference internal" href="#project-code">project_code</a></li>
<li class="toctree-l3"><a class="reference internal" href="#region">region</a></li>
<li class="toctree-l3"><a class="reference internal" href="#template-bucket-name">template_bucket_name</a></li>
<li class="toctree-l3"><a class="reference internal" href="#template-key-prefix">template_key_prefix</a></li>
<li class="toctree-l3"><a class="reference internal" href="#require-version">require_version</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#cascading-config">Cascading Config</a></li>
<li class="toctree-l2"><a class="reference internal" href="#templating">Templating</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#var">Var</a></li>
<li class="toctree-l3"><a class="reference internal" href="#environment-variables">Environment Variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="#command-path">Command Path</a></li>
<li class="toctree-l3"><a class="reference internal" href="#template-defaults">Template Defaults</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#examples">Examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="stack_config.html">Stack Config</a></li>
<li class="toctree-l1"><a class="reference internal" href="templates.html">Templates</a></li>
<li class="toctree-l1"><a class="reference internal" href="hooks.html">Hooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="resolvers.html">Resolvers</a></li>
<li class="toctree-l1"><a class="reference internal" href="architecture.html">Architecting Sceptre</a></li>
</ul>
<p class="caption"><span class="caption-text">Support</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ</a></li>
</ul>
<p class="caption"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../apidoc/modules.html">sceptre</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Sceptre</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>StackGroup Config</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/docs/stack_group_config.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="stackgroup-config">
<h1>StackGroup Config<a class="headerlink" href="#stackgroup-config" title="Permalink to this headline">¶</a></h1>
<p>StackGroup config stores information related to the StackGroup, such as a
particular profile to use, the name of the S3 bucket in which to store
templates, and the target region in which to build resources. StackGroup config
is stored in various files around the directory structure, all with the name
<code class="docutils literal"><span class="pre">config.yaml</span></code>.</p>
<div class="section" id="structure">
<h2>Structure<a class="headerlink" href="#structure" title="Permalink to this headline">¶</a></h2>
<p>An StackGroup config file is a yaml object of key-value pairs configuring
Sceptre. The available keys are listed below.</p>
<ul class="simple">
<li><a class="reference external" href="#project_code">project_code</a> <em>(required)</em></li>
<li><a class="reference external" href="#region">region</a> <em>(required)</em></li>
<li><a class="reference external" href="#profile">profile</a> <em>optional</em></li>
<li><a class="reference external" href="#required_version">required_version</a> <em>(optional)</em></li>
<li><a class="reference external" href="#template_bucket_name">template_bucket_name</a> <em>(optional)</em></li>
<li><a class="reference external" href="#template_key_prefix">template_key_prefix</a> <em>(optional)</em></li>
</ul>
<p>Sceptre will only check for and uses the above keys in StackGroup config files
and are directly accessible from Stack(). Any other keys added by the user are
made available via <code class="docutils literal"><span class="pre">stack_group_confg</span></code> attribute on <code class="docutils literal"><span class="pre">Stack()</span></code>.</p>
<div class="section" id="profile">
<h3>profile<a class="headerlink" href="#profile" title="Permalink to this headline">¶</a></h3>
<p>The name of the profile as defined in <code class="docutils literal"><span class="pre">~/.aws/config</span></code> and
<code class="docutils literal"><span class="pre">~/.aws/credentials</span></code>.</p>
</div>
<div class="section" id="project-code">
<h3>project_code<a class="headerlink" href="#project-code" title="Permalink to this headline">¶</a></h3>
<p>A string which is prepended to the Stack names of all Stacks built by Sceptre.</p>
</div>
<div class="section" id="region">
<h3>region<a class="headerlink" href="#region" title="Permalink to this headline">¶</a></h3>
<p>The AWS region to build Stacks in. Sceptre should work in any <a class="reference external" href="http://docs.aws.amazon.com/general/latest/gr/rande.html#cfn_region">region which
supports CloudFormation</a>.</p>
</div>
<div class="section" id="template-bucket-name">
<h3>template_bucket_name<a class="headerlink" href="#template-bucket-name" title="Permalink to this headline">¶</a></h3>
<p>The name of an S3 bucket to upload CloudFormation Templates to. Note that S3
bucket names must be globally unique. If the bucket does not exist, Sceptre
creates one using the given name, in the AWS region specified by <code class="docutils literal"><span class="pre">region</span></code>.</p>
<p>If this parameter is not added, Sceptre does not upload the template to S3, but
supplies the template to Boto3 via the <code class="docutils literal"><span class="pre">TemplateBody</span></code> argument. Templates
supplied in this way have a lower maximum length, so using the
<code class="docutils literal"><span class="pre">template_bucket_name</span></code> parameter is recommended.</p>
</div>
<div class="section" id="template-key-prefix">
<h3>template_key_prefix<a class="headerlink" href="#template-key-prefix" title="Permalink to this headline">¶</a></h3>
<p>A string which is prefixed onto the key used to store templates uploaded to S3.
Templates are stored using the key:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>&lt;template_key_prefix&gt;/&lt;region&gt;/&lt;stack_group&gt;/&lt;stack_name&gt;-&lt;timestamp&gt;.&lt;extension&gt;
</pre></div>
</div>
<p>Template key prefix can contain slashes (“/”), which are displayed as
directories in the S3 console.</p>
<p>Extension can be <code class="docutils literal"><span class="pre">json</span></code> or <code class="docutils literal"><span class="pre">yaml</span></code>.</p>
<p>Note that if <code class="docutils literal"><span class="pre">template_bucket_name</span></code> is not supplied, this parameter is
ignored.</p>
</div>
<div class="section" id="require-version">
<h3>require_version<a class="headerlink" href="#require-version" title="Permalink to this headline">¶</a></h3>
<p>A <a class="reference external" href="https://www.python.org/dev/peps/pep-0440/#version-specifiers">PEP 440</a> compatible version specifier. If the Sceptre version does not fall
within the given version requirement it will abort.</p>
</div>
</div>
<div class="section" id="cascading-config">
<h2>Cascading Config<a class="headerlink" href="#cascading-config" title="Permalink to this headline">¶</a></h2>
<p>Using Sceptre, config files are cascaded. Given the following sceptre directory
structure:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>.
└── config
    ├── account-1
    │   ├── config.yaml
    │   └── dev
    │       └── config.yaml
    └── config.yaml
</pre></div>
</div>
<p>General configurations should be defined at a high level, and more specific
configurations should be defined at a lower directory level.</p>
<p>YAML files that define configuration settings with conflicting keys, the child
configuration file will take precedence.</p>
<p>In the above directory structure, <code class="docutils literal"><span class="pre">config/config.yaml</span></code> will be read in first,
followed by <code class="docutils literal"><span class="pre">config/account-1/config.yaml</span></code>, followed by
<code class="docutils literal"><span class="pre">config/account-1/dev/config.yaml</span></code>.</p>
<p>For example, if you wanted the <code class="docutils literal"><span class="pre">dev</span></code> StackGroup to build to a different
region, this setting could be specified in the <code class="docutils literal"><span class="pre">config/dev/config.yaml</span></code> file,
and would only be applied to builds in the <code class="docutils literal"><span class="pre">dev</span></code> StackGroup.</p>
</div>
<div class="section" id="templating">
<span id="stack-group-config-templating"></span><h2>Templating<a class="headerlink" href="#templating" title="Permalink to this headline">¶</a></h2>
<p>Sceptre supports the use of templating in config files. Templating allows
config files to be further configured using values from the command line,
environment variables, files or parts of the <code class="docutils literal"><span class="pre">command_path</span></code>.</p>
<p>Internally, Sceptre uses Jinja2 for templating, so any valid Jinja2 syntax
should work with Sceptre templating.</p>
<p>Templating can be used for any values in the config files, not just those that
are used by Sceptre.</p>
<div class="section" id="var">
<h3>Var<a class="headerlink" href="#var" title="Permalink to this headline">¶</a></h3>
<p>User variables are used to replace the value of any item in a config file with
a value defined by a CLI flag or in a YAML variable file:</p>
<div class="highlight-jinja"><div class="highlight"><pre><span></span><span class="x">profile: </span><span class="cp">{%</span> <span class="k">raw</span> <span class="cp">%}</span>{{ var.profile }}<span class="cp">{%</span> <span class="k">endraw</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">region: eu-west-1</span>
</pre></div>
</div>
<p>This item can be set using either a command line flag:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>sceptre --var &quot;profile=&lt;your profile&gt;&quot; &lt;COMMAND&gt;
</pre></div>
</div>
<p>Or from a YAML variable file:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>sceptre --var-file=variables.yaml &lt;COMMAND&gt;
</pre></div>
</div>
<p>where <code class="docutils literal"><span class="pre">variables.yaml</span></code> contains:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">profile</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;your profile&gt;</span>
</pre></div>
</div>
<p>Both the <code class="docutils literal"><span class="pre">--var</span></code> and <code class="docutils literal"><span class="pre">--var-file</span></code> flags can be used multiple times. If
multiple <code class="docutils literal"><span class="pre">--var-file</span></code> options are supplied, the variables from these files
will be merged, with a higher precedence given to options specified later in
the command. Values supplied using <code class="docutils literal"><span class="pre">--var</span></code> take the highest precedence and
will overwrite any value defined in the variable files.</p>
<p>For example if we have the following variable files:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">---- default.yaml</span>
<span class="l l-Scalar l-Scalar-Plain">region</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">eu-west-1</span>
<span class="l l-Scalar l-Scalar-Plain">profile</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">dev</span>
<span class="l l-Scalar l-Scalar-Plain">project_code</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">api</span>

<span class="l l-Scalar l-Scalar-Plain">---- prod.yaml</span>
<span class="l l-Scalar l-Scalar-Plain">profile</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">prod</span>
</pre></div>
</div>
<p>The following sceptre command:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>sceptre --var-file=default.yaml --var-file=prod.yaml --var region=us-east-1 &lt;COMMAND&gt;
</pre></div>
</div>
<p>Will result in the following variables being available to the jinja templating:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">region</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">us-east-1</span>
<span class="l l-Scalar l-Scalar-Plain">profile</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">prod</span>
<span class="l l-Scalar l-Scalar-Plain">project_code</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">api</span>
</pre></div>
</div>
<p>For command line flags, Sceptre splits the string on the first equals sign “=”,
and sets the key to be the first substring, and the value to be the second. Due
to the large number of possible user inputs, no error checking is performed on
the value of the –var flag, and it is the user’s responsibility to make sure
that the value is correctly formatted.</p>
<p>All user variables are supplied to all config files, so users must be careful
to make sure that user variable names do not unintentionally clash.</p>
</div>
<div class="section" id="environment-variables">
<h3>Environment Variables<a class="headerlink" href="#environment-variables" title="Permalink to this headline">¶</a></h3>
<p>Config item values can be replaced with environment variables:</p>
<div class="highlight-jinja"><div class="highlight"><pre><span></span><span class="x">profile: </span><span class="cp">{%</span> <span class="k">raw</span> <span class="cp">%}</span>{{ environment_variable.PROFILE }}<span class="cp">{%</span> <span class="k">endraw</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">region: eu-west-1</span>
</pre></div>
</div>
<p>Where <code class="docutils literal"><span class="pre">PROFILE</span></code> is the name of an environment variable.</p>
</div>
<div class="section" id="command-path">
<h3>Command Path<a class="headerlink" href="#command-path" title="Permalink to this headline">¶</a></h3>
<p>Config item values can be replaced with parts of the <code class="docutils literal"><span class="pre">command_path</span></code></p>
<div class="highlight-jinja"><div class="highlight"><pre><span></span><span class="x">region: </span><span class="cp">{%</span> <span class="k">raw</span> <span class="cp">%}</span>{{ command_path.0 }}<span class="cp">{%</span> <span class="k">endraw</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">profile: default</span>
</pre></div>
</div>
<p>Where the value is taken from the first part of the <code class="docutils literal"><span class="pre">command_path</span></code> from the
invoking sceptre command:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>sceptre launch eu-west-1/dev/vpc.yaml
</pre></div>
</div>
</div>
<div class="section" id="template-defaults">
<h3>Template Defaults<a class="headerlink" href="#template-defaults" title="Permalink to this headline">¶</a></h3>
<p>Any templated value can be supplied with a default value with the syntax:</p>
<div class="highlight-jinja"><div class="highlight"><pre><span></span><span class="cp">{%</span> <span class="k">raw</span> <span class="cp">%}</span>{{ var.value | default(&quot;default_value&quot;) }}<span class="cp">{%</span> <span class="k">endraw</span> <span class="cp">%}</span><span class="x"></span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">profile</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">profile</span>
<span class="l l-Scalar l-Scalar-Plain">project_code</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">prj</span>
<span class="l l-Scalar l-Scalar-Plain">region</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">eu-west-1</span>
<span class="l l-Scalar l-Scalar-Plain">template_bucket_name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">sceptre-artifacts</span>
<span class="l l-Scalar l-Scalar-Plain">template_key_prefix</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">my/prefix</span>
</pre></div>
</div>
<div class="highlight-jinja"><div class="highlight"><pre><span></span><span class="cp">{%</span> <span class="k">raw</span> <span class="cp">%}</span>
profile: {{ var.profile }}
project_code: {{ var.project_code | default(&quot;prj&quot;) }}
region: {{ command_path.2 }}
template_bucket_name: {{ environment_variable.TEMPLATE_BUCKET_NAME }}
<span class="cp">{%</span> <span class="k">endraw</span> <span class="cp">%}</span><span class="x"></span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="stack_config.html" class="btn btn-neutral float-right" title="Stack Config" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="cli.html" class="btn btn-neutral float-left" title="Command Line Interface" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Cloudreach

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  
    <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Read the Docs</span>
      v: 98.2.1
      <span class="fa fa-caret-down"></span>
    </span>

        <div class="rst-other-versions">
            <dl id="other-versions">
                <dt>Versions</dt>
            </dl>
            <dl>
                <dt>Other Links</dt>
                <dd>
                    <a href="///projects//?fromdocs=">Project Home(TODO)</a>
                </dd>
                <dd>
                    <a href="///builds//?fromdocs=">Builds(TODO)</a>
                </dd>
            </dl>
            <hr/>
            Free document hosting provided by <a href="http://www.readthedocs.org">Read the Docs</a>
                .

        </div>
        <script>
            document.addEventListener("DOMContentLoaded", function () {
                $.getScript("../../version-helper.js").done(
                    function () {
                        versions.forEach(function (item, index) {
                            if (item !== "98.2.1") {
                                $('#other-versions').append('<dd><a href="'+ window.location.origin + '/' + item +'">' + item + "<a/></dd>");
                            }
                        })
                    });
            });
        </script>
    </div>


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>